(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{4654:function(e,t,r){Promise.resolve().then(r.bind(r,795))},795:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var s=r(7437),a=r(9501),n=r(3590),o=r(7119),l=r(9376),i=r(2265),c=r(7689),d=r(6858),m=r(2141);let u=o.Ry({partnerName:o.Z_().min(1,"Partner's name is required"),yourEmail:o.Z_().email("Valid email is required"),phone:o.Z_().min(1,"Phone is required"),customMessage:o.Z_().optional()});function p(){let e=(0,l.useRouter)(),t=(0,i.useRef)(null),[r,o]=(0,i.useState)(null),[p,x]=(0,i.useState)(null),[h,g]=(0,i.useState)(!1),[f,b]=(0,i.useState)(null),{register:y,handleSubmit:j,formState:{errors:N}}=(0,a.cI)({resolver:(0,n.F)(u),defaultValues:{partnerName:"",yourEmail:"",phone:"",customMessage:""}}),w=async t=>{b(null),g(!0);try{let s=null;if(r){let e=r.name.split(".").pop()||"jpg",t="".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2),".").concat(e),{error:a}=await m.O.storage.from(m.Z).upload(t,r,{contentType:r.type,upsert:!1});if(a){b(a.message||"Photo upload failed."),g(!1);return}let{data:n}=m.O.storage.from(m.Z).getPublicUrl(t);s=n.publicUrl}let{data:a,error:n}=await m.O.from("proposals").insert({partner_name:t.partnerName,your_email:t.yourEmail,phone:t.phone,custom_message:t.customMessage||null,photo_url:s}).select("id").single();if(n){b(n.message||"Failed to save proposal."),g(!1);return}if(null==a?void 0:a.id){e.push("/payment/".concat(a.id));return}b("No ID returned from server.")}catch(e){b(e instanceof Error?e.message:"Something went wrong.")}finally{g(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-pink-100 via-pink-50 to-rose-100 flex items-center justify-center p-4",children:(0,s.jsx)("div",{className:"w-full max-w-lg",children:(0,s.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl shadow-pink-200/50 p-8 md:p-10",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-center text-pink-600 mb-8",children:"Create Proposal"}),(0,s.jsxs)("form",{onSubmit:j(w),className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1.5",children:["Partner's Name ",(0,s.jsx)("span",{className:"text-pink-500",children:"*"})]}),(0,s.jsx)("input",{...y("partnerName"),type:"text",placeholder:"e.g. Jessica",className:"w-full px-4 py-3 rounded-xl border-2 bg-white placeholder:text-gray-400 focus:outline-none focus:ring-0 transition-colors ".concat(N.partnerName?"border-red-300 focus:border-red-500":"border-pink-200 focus:border-pink-500")}),N.partnerName&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:N.partnerName.message})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1.5",children:["Your Email ",(0,s.jsx)("span",{className:"text-pink-500",children:"*"})]}),(0,s.jsx)("input",{...y("yourEmail"),type:"email",placeholder:"you@email.com",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 bg-white placeholder:text-gray-400 focus:outline-none focus:ring-0 focus:border-pink-500 transition-colors ".concat(N.yourEmail?"border-red-300":"")}),N.yourEmail&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:N.yourEmail.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1.5",children:["Phone ",(0,s.jsx)("span",{className:"text-pink-500",children:"*"})]}),(0,s.jsx)("input",{...y("phone"),type:"tel",placeholder:"9999999999",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 bg-white placeholder:text-gray-400 focus:outline-none focus:ring-0 focus:border-pink-500 transition-colors ".concat(N.phone?"border-red-300":"")}),N.phone&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:N.phone.message})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-800 mb-1.5",children:"Custom Message (Optional)"}),(0,s.jsx)("textarea",{...y("customMessage"),placeholder:"e.g. Can't wait for our dinner date! \uD83E\uDD42",rows:3,className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 bg-white placeholder:text-gray-400 focus:outline-none focus:ring-0 focus:border-pink-500 transition-colors resize-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-800 mb-1.5",children:"Upload Photo"}),(0,s.jsx)("input",{ref:t,type:"file",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&(o(r),x(URL.createObjectURL(r)))},className:"hidden"}),(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.click()},className:"w-full min-h-[140px] rounded-xl border-2 border-dashed border-gray-300 bg-gray-50 hover:bg-gray-100 hover:border-pink-300 transition-colors flex flex-col items-center justify-center gap-2 text-gray-500 hover:text-pink-600",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:p,alt:"Preview",className:"max-h-24 w-auto rounded-lg object-cover"}),(0,s.jsx)("span",{className:"text-sm",children:"Click to change photo"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{className:"w-10 h-10",strokeWidth:1.5}),(0,s.jsx)("span",{className:"text-sm",children:"Click to upload photo"})]})})]}),f&&(0,s.jsx)("p",{className:"text-sm text-red-500 text-center",children:f}),(0,s.jsxs)("button",{type:"submit",disabled:h,className:"w-full py-3.5 px-4 rounded-xl bg-pink-500 hover:bg-pink-600 text-white font-medium shadow-lg shadow-pink-200/50 flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed transition-colors",children:[h?"Savingâ€¦":"Continue",(0,s.jsx)(d.Z,{className:"w-5 h-5"})]})]})]})})})}},2141:function(e,t,r){"use strict";r.d(t,{O:function(){return s},Z:function(){return a}});let s=(0,r(3053).eI)("https://lvyefraepxndfmczyoyh.supabase.co","sb_publishable_m4NCy1K3_IPgnZ1-0ymnEg_GnQ20oZ3"),a="valentine-photos"}},function(e){e.O(0,[303,989,971,117,744],function(){return e(e.s=4654)}),_N_E=e.O()}]);